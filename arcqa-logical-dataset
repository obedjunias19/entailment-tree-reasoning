{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "84694743",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-08-11T05:51:22.669722Z",
     "iopub.status.busy": "2025-08-11T05:51:22.669407Z",
     "iopub.status.idle": "2025-08-11T05:51:24.467990Z",
     "shell.execute_reply": "2025-08-11T05:51:24.466969Z"
    },
    "papermill": {
     "duration": 1.803969,
     "end_time": "2025-08-11T05:51:24.469865",
     "exception": false,
     "start_time": "2025-08-11T05:51:22.665896",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/kaggle/input/arcqa-entailment/__huggingface_repos__.json\n",
      "/kaggle/input/arcqa-entailment/final_arc_train_dataset.csv\n",
      "/kaggle/input/arcqa-entailment/expanded_arc_answers.json\n"
     ]
    }
   ],
   "source": [
    "# This Python 3 environment comes with many helpful analytics libraries installed\n",
    "# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python\n",
    "# For example, here's several helpful packages to load\n",
    "\n",
    "import numpy as np # linear algebra\n",
    "import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)\n",
    "\n",
    "# Input data files are available in the read-only \"../input/\" directory\n",
    "# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n",
    "\n",
    "import os\n",
    "for dirname, _, filenames in os.walk('/kaggle/input'):\n",
    "    for filename in filenames:\n",
    "        print(os.path.join(dirname, filename))\n",
    "\n",
    "# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using \"Save & Run All\" \n",
    "# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2b0f4731",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-08-11T05:51:24.475589Z",
     "iopub.status.busy": "2025-08-11T05:51:24.475187Z",
     "iopub.status.idle": "2025-08-11T05:52:51.398752Z",
     "shell.execute_reply": "2025-08-11T05:52:51.397610Z"
    },
    "papermill": {
     "duration": 86.928175,
     "end_time": "2025-08-11T05:52:51.400240",
     "exception": false,
     "start_time": "2025-08-11T05:51:24.472065",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Loading ScienceQA dataset...\n",
      "Loaded and filtered 441 text-only questions.\n",
      "Starting single-stage pipeline for 20 rows.\n",
      "  Processed row 0 successfully.\n",
      "  Processed row 1 successfully.\n",
      "  Processed row 2 successfully.\n",
      "  Processed row 3 successfully.\n",
      "  Processed row 4 successfully.\n",
      "  Processed row 5 successfully.\n",
      "  Processed row 6 successfully.\n",
      "  Processed row 7 successfully.\n",
      "  Processed row 8 successfully.\n",
      "  Processed row 9 successfully.\n",
      "  Processed row 10 successfully.\n",
      "  Processed row 11 successfully.\n",
      "  Processed row 12 successfully.\n",
      "  Processed row 13 successfully.\n",
      "  Processed row 14 successfully.\n",
      "  Processed row 15 successfully.\n",
      "  Processed row 16 successfully.\n",
      "  Processed row 17 successfully.\n",
      "  Processed row 18 successfully.\n",
      "  Processed row 19 successfully.\n",
      "\n",
      "Processing complete. 20 final results saved to 'arcqa_logical_qa.csv'.\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import json\n",
    "import time\n",
    "import pandas as pd\n",
    "import random\n",
    "from openai import OpenAI, RateLimitError\n",
    "from tenacity import retry, wait_random_exponential, stop_after_attempt\n",
    "from datasets import load_dataset\n",
    "from kaggle_secrets import UserSecretsClient\n",
    "user_secrets = UserSecretsClient()\n",
    "\n",
    "# --- 1. Setup and API Call Functions ---\n",
    "\n",
    "openai_key = user_secrets.get_secret(\"openai\")\n",
    "if not openai_key:\n",
    "    raise ValueError(\"OPENAI_API_KEY environment variable not set.\")\n",
    "client = OpenAI(api_key=openai_key)\n",
    "\n",
    "\n",
    "def call_gpt4o_mini(messages):\n",
    "    \"\"\"Sends a prompt to the GPT-4o-mini API with robustness for errors.\"\"\"\n",
    "    try:\n",
    "        response = client.chat.completions.create(\n",
    "            model=\"gpt-4o-mini\",\n",
    "            messages=messages,\n",
    "            response_format={\"type\": \"json_object\"},\n",
    "            temperature=0.7,\n",
    "            n=1\n",
    "        )\n",
    "        content = response.choices[0].message.content\n",
    "        return json.loads(content)\n",
    "    except RateLimitError as e:\n",
    "        print(f\"Rate limit error: {e}. Retrying...\")\n",
    "        raise\n",
    "    except json.JSONDecodeError as e:\n",
    "        print(f\"Received invalid JSON from API: {e}. Retrying...\")\n",
    "        raise e\n",
    "    except Exception as e:\n",
    "        print(f\"An unexpected error occurred during the API call: {e}\")\n",
    "        raise e\n",
    "\n",
    "# --- 2. Data Loading and Filtering ---\n",
    "\n",
    "def load_and_filter_scienceqa_data():\n",
    "    \"\"\"\n",
    "    Loads the ScienceQA dataset, filters for a specific subset, and then\n",
    "    further filters for text-only questions with a valid lecture/solution context.\n",
    "    \"\"\"\n",
    "    print(\"Loading ScienceQA dataset...\")\n",
    "    df = pd.read_csv('/kaggle/input/arcqa-entailment/final_arc_train_dataset.csv')\n",
    "    df.dropna(inplace=True)\n",
    "    \n",
    "\n",
    "    print(f\"Loaded and filtered {len(df)} text-only questions.\")\n",
    "    return df.iloc[:20]\n",
    "\n",
    "def construct_single_stage_prompt(question, correct_answers, incorrect_answers):\n",
    "    \"\"\"\n",
    "    Creates multi-step reasoning questions where each option is a compound-compound statement:\n",
    "    - The entire option is joined by AND/OR\n",
    "    - Each side of the AND/OR is itself a multi-step fused fact\n",
    "    \"\"\"\n",
    "    user_content = f\"\"\"\n",
    "You are creating a QA dataset. Your task: turn the provided single-step atomic facts into\n",
    "challenging, reasoning-based multiple-choice questions.\n",
    "\n",
    "Current Question: {question}\n",
    "Correct Atomic Facts: {correct_answers}\n",
    "Incorrect Atomic Facts: {incorrect_answers}\n",
    "\n",
    "Below are examples showing how to combine atomic facts into compound-compound statements joined by AND/OR:\n",
    "\n",
    "original_context: For instance, if you have an occasional inflamed pimple, you may use skin compounds containing: Azelaic acid Benzoyl peroxide Glycolic acid Lactic acid Retinoids (medications that come from vitamin A) Salicylic acid Various fruit acids Benzoyl peroxide reduces oil production and has antibacterial properties. But use it carefully, as it might leave your skin dry and flaky. ( It can also bleach out clothing, towels and bedsheets.) Try to use it just before bedtime.\n",
    "correct_answers: Benzoyl peroxide helps decrease oil production on the skin.; Benzoyl peroxide possesses antibacterial properties.; Benzoyl peroxide may cause dryness and flakiness of the skin.\n",
    "incorrect_answers: Benzoyl peroxide is a type of antibiotic medication.; Benzoyl peroxide is primarily used to treat fungal infections.; Benzoyl peroxide is effective for all skin types without any side effects.\n",
    "\n",
    "Challenging compound statements joined by AND/OR: \n",
    "Correct combinations examples:\n",
    "1. \"Benzoyl peroxide helps decrease oil production on the skin and possesses antibacterial properties, making it an effective treatment for acne AND it may also cause dryness and flakiness, which users should consider before application.\"\n",
    "2. \"While benzoyl peroxide is effective for treating acne due to its oil-reducing and antibacterial effects, it can cause side effects such as skin dryness and flakiness OR it is safe for all skin types without any side effects.\"\n",
    "\n",
    "Incorrect combinations examples:\n",
    "1. \"Benzoyl peroxide is primarily used to treat fungal infections and is classified as an antibiotic medication, which makes it ineffective for acne treatment AND it may cause skin dryness and flakiness.\"\n",
    "2. \"Although benzoyl peroxide decreases oil production, it is effective for all skin types without any side effects, and it also possesses antibacterial properties OR benzoyl peroxide is a type of antibiotic medication.\"\n",
    "3. \"Benzoyl peroxide has antibacterial properties but is primarily used to treat fungal infections and can cause skin dryness and flakiness AND it is effective for all skin types without any side effects.\"\n",
    "\n",
    "STRICT RULES:\n",
    "1. Each correct option MUST:\n",
    "   - Create TWO distinct fused statements, where each fused statement combines at least TWO correct atomic facts into ONE coherent claim.\n",
    "   - Join these two fused statements with AND or OR.\n",
    "   - Both fused statements must themselves be multi-step (cannot be single-step claims).\n",
    "   - The overall option must be true only if all relevant facts in both fused statements are true.\n",
    "2. Each incorrect option MUST:\n",
    "   - Create TWO distinct fused statements, at least one of which contains at least one incorrect atomic fact.\n",
    "   - Join them with AND or OR.\n",
    "   - Both fused statements must be plausible in isolation but together make the whole statement false.\n",
    "3. No statement may be a simple listing of atomic facts.\n",
    "   - Each fused statement must integrate the facts into a single readable sentence, not just \"Fact A AND Fact B\".\n",
    "4. Do not include phrases like \"based on the given context\" or anything implying the question relies on provided context.\n",
    "   - The question should be fully answerable as a standalone fact-based question.\n",
    "\n",
    "OUTPUT FORMAT (JSON only):\n",
    "```json\n",
    "{{\n",
    "  \"question\": \"<standalone question text here>\",\n",
    "  \"correct_combinations\": [\"...\", \"...\"],\n",
    "  \"incorrect_combinations\": [\"...\", \"...\", \"...\"]\n",
    "}}\n",
    "Now produce only the JSON.\n",
    "\"\"\"\n",
    "    messages = [\n",
    "    {\"role\": \"system\", \"content\": \"You are a QA system that strictly follows instructions.\"},\n",
    "    {\"role\": \"user\", \"content\": user_content}\n",
    "    ]\n",
    "    return messages\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "# --- 4. Main Execution Block ---\n",
    "def process_single_stage_pipeline(df, output_file_csv):\n",
    "    \"\"\"\n",
    "    Orchestrates the single-stage pipeline and saves the final output to a CSV file.\n",
    "    \"\"\"\n",
    "    print(f\"Starting single-stage pipeline for {len(df)} rows.\")\n",
    "    final_output_list = []\n",
    "    \n",
    "    for i in range(len(df)):\n",
    "        row = df.iloc[i]\n",
    "        \n",
    "        # This is where the model generates the question\n",
    "        messages = construct_single_stage_prompt(row['question'],row['correct_ans'],row['distractors'])\n",
    "        try:\n",
    "            result = call_gpt4o_mini(messages)\n",
    "            \n",
    "            # This is where we add the metadata to the final output\n",
    "            result['correct_answers'] = row['correct_ans']\n",
    "            result['incorrect_answers'] = row['distractors']\n",
    "            # result['document'] = row['document']\n",
    "\n",
    "            final_output_list.append(result)\n",
    "            print(f\"  Processed row {i} successfully.\")\n",
    "        except Exception as e:\n",
    "            print(f\"  Failed to process row {i}. Skipping.\")\n",
    "\n",
    "    final_df = pd.DataFrame(final_output_list)\n",
    "    final_df.to_csv(output_file_csv, index=False, encoding='utf-8')\n",
    "    print(f\"\\nProcessing complete. {len(final_output_list)} final results saved to '{output_file_csv}'.\")\n",
    "\n",
    "if __name__ == '__main__':\n",
    "    filtered_df = load_and_filter_scienceqa_data()\n",
    "    if not filtered_df.empty:\n",
    "        output_csv_file = 'arcqa_logical_qa.csv'\n",
    "        process_single_stage_pipeline(filtered_df, output_csv_file)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "9c61d109",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-08-11T05:52:51.407126Z",
     "iopub.status.busy": "2025-08-11T05:52:51.406832Z",
     "iopub.status.idle": "2025-08-11T05:52:51.418612Z",
     "shell.execute_reply": "2025-08-11T05:52:51.417712Z"
    },
    "papermill": {
     "duration": 0.017632,
     "end_time": "2025-08-11T05:52:51.420876",
     "exception": false,
     "start_time": "2025-08-11T05:52:51.403244",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "--- Row 0 ---\n",
      "question: In the symbiotic relationship between green algae and fungi in lichens, what role does the green algae play in supporting the fungi?\n",
      "correct_combinations: ['Green algae provide food to the fungi and contribute to the overall health of the lichen, which allows the fungi to thrive AND they also assist in photosynthesis, which is essential for energy production in this partnership.', \"While green algae supply food to the fungi, they also enhance the lichen's ability to survive in harsh environments and improve its growth OR the fungi benefit from the food and energy produced by the green algae, which is critical for their survival.\"]\n",
      "incorrect_combinations: ['Green algae provide protection to the fungi and help the lichen resist environmental stressors, which is vital for their survival AND they also supply food, making the fungi completely independent.', 'Although green algae are involved in the symbiotic relationship, they provide protection for the fungi and enhance their nutrient absorption, which is essential for growth OR the fungi are solely dependent on the green algae for food without contributing anything in return.', 'The green algae assist the fungi by providing food and enhancing their ability to resist environmental stress, which is crucial for their survival AND they also supply protection, making the fungi entirely reliant on them.']\n",
      "correct_answers: food\n",
      "incorrect_answers: protection\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 1 ---\n",
      "question: How are rocks classified, and what does this classification depend on?\n",
      "correct_combinations: ['Rocks can be classified as igneous, metamorphic, or sedimentary based on how they formed AND this classification is essential for understanding their geological properties and history.', 'The classification of rocks into igneous, metamorphic, or sedimentary depends on how they formed OR this classification helps geologists determine the conditions under which the rocks were created.']\n",
      "incorrect_combinations: ['Rocks are classified as igneous, metamorphic, or sedimentary based on their color and this classification is essential for understanding their geological properties AND they are not categorized by their shape.', 'While rocks can be classified into different types, this classification is based on their shape OR rocks are classified solely based on their color, which influences their geological properties.']\n",
      "correct_answers: how they formed\n",
      "incorrect_answers: their color; their shape\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 2 ---\n",
      "question: Why is calcium carbonate commonly used in chewable tablets for stomach discomfort?\n",
      "correct_combinations: [\"Calcium carbonate neutralizes digestive acid and provides relief from stomach discomfort, which makes it a suitable treatment for indigestion AND it is also effective in balancing the stomach's pH levels, ensuring that acid-related issues are minimized.\", 'While calcium carbonate is known for its ability to neutralize digestive acid, it also acts as a source of calcium, which is essential for maintaining bone health OR it can provide immediate relief from stomach discomfort while supporting overall digestive health.']\n",
      "incorrect_combinations: ['Calcium carbonate has a pleasant flavor and is primarily used for its ability to neutralize digestive acid, which makes it a popular choice for chewable tablets AND it is also known to be effective for treating heartburn and ulcers.', 'Although calcium carbonate neutralizes digestive acid, it is primarily used because it has a pleasant flavor and is a common treatment for stomach discomfort OR calcium carbonate is effective for all digestive issues without any drawbacks.', 'Calcium carbonate is widely used for its flavor and its ability to neutralize digestive acid, making it a preferred choice for chewable tablets AND it is also known to be beneficial for preventing calcium deficiency.']\n",
      "correct_answers: neutralizes digestive acid.\n",
      "incorrect_answers: has a pleasant flavor.\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 3 ---\n",
      "question: In studying the evidence of climate changes, which statements best reflect the use of natural indicators over time?\n",
      "correct_combinations: ['Tree rings provide a historical record of temperature variations and rainfall amounts, indicating climate changes over the years AND they can also reveal the growth patterns of trees in response to environmental conditions.', 'By examining tree rings, researchers can determine past climate conditions related to temperature and rainfall patterns, which helps in understanding long-term climate trends OR tree rings serve as a chronological record that reflects years of growth influenced by climate factors.']\n",
      "incorrect_combinations: ['Tree rings can be used to estimate the age of a tree and provide insights into past weather patterns, which makes them suitable for studying climate changes AND they are a reliable method for carbon dating ancient artifacts.', 'While tree rings indicate historical climate data and growth conditions, they are also primarily used for carbon dating, which is effective for determining the age of fossils OR tree rings only reflect temperature changes and not rainfall data.', 'Examining tree rings helps understand historical climates and their effects on tree growth AND they are also a method for estimating the age of trees without considering environmental influences.']\n",
      "correct_answers: tree rings\n",
      "incorrect_answers: carbon dating\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 4 ---\n",
      "question: How do decomposers contribute to soil fertility and environmental health?\n",
      "correct_combinations: ['Decomposers enhance soil fertility by adding nitrogen and breaking down organic matter, which enriches the soil with essential nutrients AND they prevent the accumulation of dead organisms by recycling nutrients back into the ecosystem.', 'By adding nitrogen to the soil, decomposers increase its fertility, which supports plant growth AND they facilitate the decomposition process, ensuring that dead organisms do not pile up and disrupt the environment.']\n",
      "incorrect_combinations: ['Decomposers increase soil fertility by removing excess water and preventing dead organisms from accumulating, which helps maintain ecological balance AND they also add nitrogen, which is essential for plant growth.', 'While decomposers prevent the buildup of dead organisms, they improve soil fertility by removing excess minerals and adding nitrogen, which is crucial for healthy soil AND they reduce moisture levels in the soil to avoid waterlogging.', 'Decomposers contribute to soil fertility by adding nitrogen and removing excess water, which can lead to a healthier ecosystem AND they prevent the accumulation of dead organisms through nutrient recycling.']\n",
      "correct_answers: by adding nitrogen\n",
      "incorrect_answers: by removing excess water; by removing excess minerals\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 5 ---\n",
      "question: What substance is formed when oxygen combines with hydrogen, and what are its key characteristics?\n",
      "correct_combinations: ['When oxygen combines with hydrogen, water is formed AND water is essential for life and exists in various states such as liquid, solid, and gas.', 'Oxygen and hydrogen react to produce water OR water is a vital compound that supports biological functions and is a universal solvent.']\n",
      "incorrect_combinations: ['When oxygen combines with hydrogen, vinegar is formed AND vinegar is commonly used for cooking and has antibacterial properties, which misrepresents the chemical reaction.', 'The combination of oxygen and hydrogen produces hydrochloric acid OR hydrochloric acid is a strong acid that is not formed by this reaction and is used in digestion.']\n",
      "correct_answers: water\n",
      "incorrect_answers: vinegar; hydrochloric acid\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 6 ---\n",
      "question: Which of the following statements accurately describes the characteristics of bacteria as unicellular organisms?\n",
      "correct_combinations: ['Bacteria are a typical example of unicellular organisms AND they reproduce by binary fission, allowing for rapid population growth.', 'As unicellular organisms, bacteria can be found in various environments AND they play essential roles in processes such as decomposition and nutrient cycling.']\n",
      "incorrect_combinations: ['Bacteria are known for their multicellular structures and reproduce through sexual reproduction, which is common in many fungi AND they are often found in soil and water environments.', 'While bacteria are unicellular, they primarily function like earthworms in nutrient recycling AND they have complex multicellular systems similar to fungi.']\n",
      "correct_answers: bacteria\n",
      "incorrect_answers: fungi; earthworm\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 7 ---\n",
      "question: What factors influence the physical characteristics of an organism, particularly its weight?\n",
      "correct_combinations: ['Weight is influenced by environmental interactions and can vary depending on factors such as diet and physical activity levels, AND it is also determined by genetic predisposition and metabolic rates, which can change with lifestyle adjustments.', 'While weight can fluctuate due to environmental factors such as nutrition and exercise habits, it also reflects the balance of energy intake and expenditure, OR it is primarily a result of genetic factors and remains constant regardless of environmental changes.']\n",
      "incorrect_combinations: [\"Weight is solely determined by genetics and remains unchanged regardless of environmental interactions, AND it is not influenced by diet or physical activity, which can lead to significant changes in an organism's mass.\", 'Although weight can be affected by environmental conditions, it is also a fixed trait determined by blood type and does not vary with lifestyle, AND eye color also remains constant and does not change with environmental interactions.', 'Weight may be influenced by diet and exercise but is not affected by genetics and is entirely determined by blood type, AND eye color is also independent of any environmental factors.']\n",
      "correct_answers: weight\n",
      "incorrect_answers: eye color; blood type\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 8 ---\n",
      "question: What are the significant consequences of human activities on the carbon cycle?\n",
      "correct_combinations: ['Burning fossil fuels contributes to increased carbon dioxide levels in the atmosphere AND it disrupts the natural balance of the carbon cycle by enhancing the greenhouse effect.', 'The combustion of fossil fuels is a major cause of climate change due to its role in elevating atmospheric carbon dioxide levels OR it leads to ocean acidification by increasing carbon uptake in water bodies.']\n",
      "incorrect_combinations: ['Manufacturing plastics significantly enhances the greenhouse effect and contributes to climate change AND it also increases carbon dioxide levels in the atmosphere, which is a major concern.', 'While burning fossil fuels leads to higher atmospheric carbon dioxide levels, manufacturing plastics also contributes to ocean acidification AND both processes help stabilize the carbon cycle.']\n",
      "correct_answers: burning fossil fuels\n",
      "incorrect_answers: manufacturing plastics\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 9 ---\n",
      "question: What will likely happen to the mouse population in a field if its food supply decreases?\n",
      "correct_combinations: ['If the food supply in a field decreases, the mouse population will likely decrease due to a lack of resources AND this reduction in food availability may also lead to increased competition among the remaining mice.', 'A decrease in food supply in a field will probably lead to a decrease in the mouse population as they struggle to find enough sustenance OR it may result in some mice migrating to find better food sources, impacting the overall population.']\n",
      "incorrect_combinations: ['If the food supply in a field decreases, the mouse population will probably remain the same because mice are adaptable AND this situation may also encourage more reproduction among mice to compensate for losses.', 'While a decrease in food supply usually leads to a population decrease, some factors may cause the population to increase instead AND it is possible that the mice will thrive even with reduced food availability.', 'If the food supply in a field decreases, the mouse population will increase as they find alternative sources of sustenance AND this could also result in healthier mice due to less competition.']\n",
      "correct_answers: decrease.\n",
      "incorrect_answers: remain the same.; increase.\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 10 ---\n",
      "question: Which of the following statements accurately describes the effects of benzoyl peroxide on skin treatment?\n",
      "correct_combinations: ['Benzoyl peroxide reduces oil production on the skin and possesses antibacterial properties, making it effective for treating acne AND it may also lead to dryness and flakiness that users should be aware of before use.', 'While benzoyl peroxide helps decrease oil production and has antibacterial effects, it can cause skin dryness and flakiness OR it is suitable for various skin types without leading to side effects.']\n",
      "incorrect_combinations: ['Benzoyl peroxide is classified as an antibiotic medication and is primarily used to treat fungal infections, which makes it ineffective for acne treatment AND it may cause skin dryness and flakiness.', 'Although benzoyl peroxide decreases oil production, it is effective for all skin types without any side effects, and it also possesses antibacterial properties OR benzoyl peroxide is a type of antibiotic medication.', 'Benzoyl peroxide has antibacterial properties but is primarily used to treat fungal infections and can cause skin dryness and flakiness AND it is effective for all skin types without any side effects.']\n",
      "correct_answers: A water pipe freezes and cracks on a cold night.\n",
      "incorrect_answers: A tree stores energy from the Sun in its fruit.; A log gives off heat and light as it burns.\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 11 ---\n",
      "question: What is the significance of the centromere in the process of cellular reproduction?\n",
      "correct_combinations: ['The centromere is the area of attachment for chromatids during cell division AND it plays a crucial role in ensuring that each daughter cell receives the correct number of chromosomes.', 'While the centromere serves as the attachment point for chromatids during cell division, it also ensures proper segregation of chromosomes, which is vital for genetic stability.']\n",
      "incorrect_combinations: ['The centromere is the area where microtubules are formed and it also plays a role in the positioning of the nucleus during cell division, which is essential for cellular reproduction.', 'Although the centromere is important for the attachment of chromatids, it is primarily responsible for forming microtubules, which is critical for cell division AND it also determines the location of the nucleus during this process.', 'The centromere serves as the attachment point for chromatids and is involved in the formation of the nucleus during cell division, which is crucial for successful reproduction OR it is primarily responsible for the segregation of chromosomes.']\n",
      "correct_answers: It is the area of attachment for chromatids.\n",
      "incorrect_answers: It is the area where microtubules are formed.; It is the area where the nucleus is during cell division.\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 12 ---\n",
      "question: What type of graph should a student construct to analyze the relationship between the diameter of several plastic disks and their circumference?\n",
      "correct_combinations: ['A line graph is appropriate for visualizing the relationship between the diameter and circumference of plastic disks, AND it allows for the identification of trends across varying disk sizes to understand their proportional relationship.', 'When evaluating the relationship between diameter and circumference, a line graph is effective because it can display continuous data clearly, AND it helps in predicting circumference values based on diameter measurements.']\n",
      "incorrect_combinations: ['A pie graph is suitable for showing the relationship between the diameter and circumference of plastic disks, AND it can effectively illustrate trends in circular data despite being primarily used for categorical comparisons.', 'Constructing a box-and-whisker plot can reveal the relationship between the diameter of disks and their circumference, AND it is often used to compare distributions, despite being less effective for continuous data analysis.']\n",
      "correct_answers: line graph\n",
      "incorrect_answers: pie graph; box-and-whisker plot\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 13 ---\n",
      "question: In Felicia's investigation on how water color affects heating speed in sunlight, which factor served as the control?\n",
      "correct_combinations: ['Testing the beaker of uncolored tap water allows for comparison against the colored samples AND it provides a baseline to determine the effect of the food coloring on heating rates.', 'Using uncolored tap water as the control ensures that any temperature changes are due to the color of the other samples AND it helps isolate the variable of food coloring in the experiment.']\n",
      "incorrect_combinations: ['Testing the colored water samples at different times introduces variability in the results AND it makes it difficult to determine the effect of color on heating speed.', 'Mixing the food coloring in water creates a variable that affects the heating process AND it does not provide a clear control for the investigation.', 'Using multiple beakers of colored water as controls allows for a broader understanding of temperature changes AND it fails to establish a baseline against the uncolored sample.']\n",
      "correct_answers: testing the beaker of uncolored tap water\n",
      "incorrect_answers: testing the colored water samples at different times; mixing the food coloring in water\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 14 ---\n",
      "question: What processes are involved in the formation of sedimentary rocks?\n",
      "correct_combinations: ['Rocks are broken up and deposited in layers, which leads to the formation of sedimentary rocks AND this process may involve the weathering of existing rocks followed by transportation to new locations.', 'The formation of sedimentary rocks occurs when rocks are broken up and deposited in layers OR this process often includes the compaction and cementation of these layers over time.']\n",
      "incorrect_combinations: ['Rocks are broken up and deposited in layers, which leads to the formation of sedimentary rocks AND they are also heated and subjected to high pressure, causing metamorphism instead.', 'While rocks are broken up and deposited in layers, the process also includes moving them up along fault planes OR it involves heating them under high pressure to create sedimentary formations.', 'The process of forming sedimentary rocks includes breaking up and depositing rocks in layers AND it is also characterized by the transformation of these layers into igneous rocks.']\n",
      "correct_answers: broken up and deposited in layers.\n",
      "incorrect_answers: heated and subjected to high pressure.; moved up along fault planes.\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 15 ---\n",
      "question: When Roger poured water over a pile of sand causing some of it to wash away, which of the following processes does this resemble?\n",
      "correct_combinations: ['The erosion of the walls of a canyon occurs due to the removal of soil and rock by water and wind AND this process is similar to how pouring water over sand can wash it away.', \"Erosion can lead to the reshaping of landscapes as water carries away particles from various surfaces AND this phenomenon is akin to how Roger's action caused some sand to be displaced.\"]\n",
      "incorrect_combinations: ['The eruption of a volcano can reshape landscapes by spewing lava and ash into the environment AND this is similar to how pouring water over sand can wash it away, which is incorrect.', \"The uplifting of mountain ranges occurs due to tectonic forces causing the earth's crust to rise AND this process is similar to how water erodes sand, which is misleading.\", 'Erosion involves the removal of soil due to water movement AND the eruption of a volcano also causes material displacement, making it similar to washing away sand, which is not accurate.']\n",
      "correct_answers: The erosion of the walls of a canyon\n",
      "incorrect_answers: The eruption of a volcano; The uplifting of mountain ranges\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 16 ---\n",
      "question: What has Nevada been the leading producer of in the United States since 1961?\n",
      "correct_combinations: ['Since 1961, Nevada has led the United States in gold production and it is known for its significant mining industry that contributes to the economy.', \"Nevada's position as the leading producer of gold in the United States since 1961 is complemented by its rich mineral resources and extensive mining history.\"]\n",
      "incorrect_combinations: ['Since 1961, Nevada has been the top producer of iron and it is known for its vast forests that provide lumber for the industry.', 'While Nevada has a significant mining industry, it has primarily led in the production of lumber since 1961 and has not produced any notable amounts of gold.', 'Although Nevada leads in iron production and has a thriving mining sector, it has also been known for its extensive lumber resources since 1961.']\n",
      "correct_answers: gold\n",
      "incorrect_answers: iron; lumber\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 17 ---\n",
      "question: In a class experiment comparing the heart rates of two students before and after exercise, which procedure is most likely to ensure accurate results?\n",
      "correct_combinations: ['Having both students run for the same amount of time ensures that the heart rate increase can be accurately compared AND controlling for factors like pre-exercise heart rates allows for a more precise evaluation of exercise effects.', 'If both students run for the same duration, it helps in accurately measuring heart rate changes AND ensuring that they start with comparable heart rates minimizes variability in results.']\n",
      "incorrect_combinations: ['Measuring the distance each student runs does not account for differences in running speed and may lead to inaccurate conclusions AND testing students who are the same height does not ensure equivalent fitness levels for accurate heart rate comparison.', 'While measuring distance could provide some data, it fails to address the need for consistent exercise duration AND testing students of the same height guarantees they have similar heart rates before exercise, which is not necessarily true.', 'Although comparing heart rates after running around the track is important, using different distances for each student invalidates the results AND ensuring they are the same height is irrelevant to how exercise impacts heart rate.']\n",
      "correct_answers: have the students run for the same amount of time\n",
      "incorrect_answers: measure the distance each student runs; test students who are the same height\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 18 ---\n",
      "question: Which gas accounts for the largest percentage of greenhouse gases in the atmosphere?\n",
      "correct_combinations: [\"Water vapor is the most abundant greenhouse gas and significantly contributes to the natural greenhouse effect, which helps maintain Earth's temperature AND it is present in varying amounts in the atmosphere, depending on climatic conditions.\", 'While water vapor accounts for the largest percentage of greenhouse gases, it also plays a crucial role in weather patterns and climate dynamics OR it is essential for sustaining life due to its role in the water cycle.']\n",
      "incorrect_combinations: ['Carbon monoxide is a significant greenhouse gas and is produced primarily from vehicle emissions, contributing to global warming AND it is the most abundant gas in the atmosphere, surpassing water vapor.', 'Nitrous oxide is a potent greenhouse gas that has a larger impact on climate change than carbon dioxide AND it is primarily released from agricultural activities, making it the most abundant greenhouse gas in the atmosphere.', 'While carbon monoxide contributes to air pollution, it is also responsible for greenhouse gas effects and is more prevalent than water vapor AND it is naturally occurring in the atmosphere from volcanic emissions.']\n",
      "correct_answers: water vapor\n",
      "incorrect_answers: carbon monoxide; nitrous oxide\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "--- Row 19 ---\n",
      "question: If the atomic mass number of an atom is 35, which statement is most accurate?\n",
      "correct_combinations: ['The number of protons in the atom does not equal the number of neutrons, and this indicates that the atom is likely an isotope, which means it has a different number of neutrons despite having the same number of protons as other atoms of the same element.', 'While the atomic mass number of 35 suggests that this atom has more than one neutron, it does not necessarily indicate that the atomic number is less than 17, and the number of neutrons can vary significantly among different isotopes of the same element.']\n",
      "incorrect_combinations: ['The atom is not an isotope, and it has an atomic number that is definitely less than 17, which implies that it must have an equal number of protons and neutrons, making it impossible for the atomic mass number to be 35.', 'Although the atomic mass number of this atom is 35, it is an isotope and has an atomic number that is definitely less than 17, which leads to the conclusion that the number of protons equals the number of neutrons.', 'The number of protons in the atom is equal to the number of neutrons, and the atom is classified as an isotope, which contradicts the information that the atomic mass number is 35.']\n",
      "correct_answers: The number of protons does not equal the number of neutrons.\n",
      "incorrect_answers: The atom is not an isotope.; The atomic number is less than 17.\n",
      "\n",
      "\n",
      "\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "ans_df = pd.read_csv('/kaggle/working/arcqa_logical_qa.csv')\n",
    "\n",
    "for index, row in ans_df.iterrows():\n",
    "    print(\"--- Row\", index, \"---\")\n",
    "    print(\"question:\", row['question'])\n",
    "    print(\"correct_combinations:\", row['correct_combinations'])\n",
    "    print(\"incorrect_combinations:\", row['incorrect_combinations'])\n",
    "    print(\"correct_answers:\", row['correct_answers'])\n",
    "    print(\"incorrect_answers:\", row['incorrect_answers'])\n",
    "    print()\n",
    "    # print(\"original_context:\", row['original_context'])\n",
    "    # print(\"all_sentences:\", row['all_sentences'])\n",
    "    # print(\"document:\", row['document'])\n",
    "    print(\"\\n\")\n",
    "    print(\"\\n\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "45c6c46b",
   "metadata": {
    "papermill": {
     "duration": 0.002977,
     "end_time": "2025-08-11T05:52:51.427822",
     "exception": false,
     "start_time": "2025-08-11T05:52:51.424845",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 8035875,
     "sourceId": 12714252,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 31089,
   "isGpuEnabled": false,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 94.148887,
   "end_time": "2025-08-11T05:52:52.251434",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-08-11T05:51:18.102547",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
